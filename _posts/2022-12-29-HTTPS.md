---
title: HTTPS
author: Huey-J
date: 2022-12-26 12:00:00 +0800
categories: [데브옵스, 네트워크]
tags: [DevOps, Network]
---

# HTTPS란

### 웹 프로토콜 HTTP

HTTP는 웹 상에서 TCP 기반으로 정보를 주고받을 수 있는 웹 프로토콜 입니다. 하지만 실제로 HTTP로 웹 통신을 하고 있을까요?

정답은 X 입니다.

HTTP로 웹 페이지를 배포하고 해당 웹 사이트에 접속을 해보면 아래처럼 꽤 무서운 문구들이 표시됩니다.

![http not secured](/assets/img/http_not_secured.png)

이는 HTTPS를 사용하지 않아서 발생한 경고 메시지인데요. 그럼 HTTPS란 뭘까요?

### HTTPS

아래는 HTTPS에 대한 위키백과의 정의입니다.

> HTTPS(HyperText Transfer Protocol over Secure Socket Layer, HTTP over TLS, HTTP over SSL, HTTP Secure)는 월드 와이드 웹 통신 프로토콜인 HTTP의 보안이 강화된 버전이다.
> HTTPS는 통신의 인증과 암호화를 위해 넷스케이프 커뮤니케이션즈 코퍼레이션이 개발한 넷스케이프 웹 프로토콜이며, 전자 상거래에서 널리 쓰인다.
>
> HTTPS는 소켓 통신에서 일반 텍스트를 이용하는 대신에, SSL이나 TLS 프로토콜을 통해 세션 데이터를 암호화한다. 따라서 데이터의 적절한 보호를 보장한다. HTTPS의 기본 TCP/IP 포트는 443이다.
>
> 보호의 수준은 웹 브라우저에서의 구현 정확도와 서버 소프트웨어, 지원하는 암호화 알고리즘에 달려있다.
>
> HTTPS를 사용하는 웹페이지의 URI는 'http://'대신 'https://'로 시작한다.
>
> _출처 : [위키피디아](https://ko.wikipedia.org/wiki/HTTPS)_
> {: .text-right}

간단하게 얘기하면 HTTP에서 보안이 강화된 통신 방법이라고 볼 수 있습니다.

그럼 어떻게 HTTPS가 어떻게 HTTP보다 안전하게 통신을 할 수 있게 되었는지 알아 봅시다.


# HTTPS 통신 과정

## 오브젝트

- 인증기관 (CA)
- 서버
- 클라이언트

## 간략한 통신 과정

### 서버 SSL 인증서 발행

1. 서버는 한 쌍의 공개키와 개인키를 생성하고, 사이트의 정보와 자신의 공개키를 인증기관에 전달하여 SSL 인증서를 요청합니다.
2. 인증기관은 SSL 인증서를 만들고, 자신의 개인키로 해당 인증서를 암호화 하여 서버에게 전달합니다. 해당 인증서에는 서비스의 정보(인증서를 발급한 CA, 서비스의 도메인 등)와 서버의 공개키가 포함되어 있습니다.
3. 서버는 전달받은 암호화된 SSL을 그대로 게시합니다.

### 클라이언트 접속

1. 클라이언트는 암호화 되어 있는 서버의 인증서를 인증기관의 공개키로 복호화하고 서버의 정보를 확인합니다. 서버의 정보를 확인할 수 있다면 해당 인증서는 실제 인증서입니다. 그리고 복호화를 통해 서버의 공개키 역시 알게 되었습니다.
2. 클라이언트는 이제 서버를 신뢰하고, 해당 서버의 공개키로 데이터를 암호화하여 요청합니다.
3. 서버는 자신의 개인키로 암호화되어 있는 클라이언트의 요청을 복호화 하고 해당 요청을 처리합니다.

## 클라이언트 접속의 상세한 통신 과정

클라이언트 접속은 실제로 SSL Handshake 과정을 거칩니다.

### 1. Client Hello

- 클라이언트 -> 서버
- 클라이언트가 서버에 연결을 시도하면서 헨드셰이크를 시작하는 패킷
- 내용
  - 지원하는 TLS(SSL) 버전
  - 랜덤 바이트 문자열
  - 지원하는 암호 제품군 목록 (Cipher Suite) : SSL Protocol Version, Hash 방식 등의 정보가 담겨져 있음

![https cipher suite](/assets/img/https_cipher_suite.png)
_Image Reference : https://run-it.tistory.com/30_


### 2. Server Hello

- 서버 -> 클라이언트
- Client Hello 메시지에 대한 응답으로 서버가 보내주는 패킷
- 내용
  - 랜덤 바이트 문자열
  - 선택한 암호 제품군 (Cipher Suite) : Client Hello에서 보내준 목록 중 하나를 선택함

### 3. Certificate

- 서버 -> 클라이언트
- Server Hello 패킷과 같이 자신의 인증서를 보내주는 패킷
- 내용
  - 인증기관의 개인키로 암호화 되어 있는 SSL 인증서
  - SSL Protocol Version

### 4. Server Key Exchange

- 서버 -> 클라이언트
- 만약 SSL 안에 서버의 공개키가 없다면, 직접 공개키를 보내준다.
- 내용
  - 서버의 공개키

### 5. Verify server certificate

- 클라이언트가 서버의 SSL 인증서를 인증서 발행 기관(CA)의 공개키로 복호화하고 이를 검증합니다.
- 이를 통해 서버가 인증서에 명시된 서버인지, 클라이언트가 상호작용 중인 서버가 실제 해당 도메인의 소유자인지를 확인하고, 해당 서버의 공개키까지 갖게 되었습니다.

### 6. Client Key Exchange

- 클라이언트 -> 서버
- 클라이언트는 대칭키를 생성하여 서버의 공개키로 암호화하여 전송합니다.
- 해당 대칭키를 통해 실제로 암호화 통신을 진행합니다.
- 내용
  - 암호화된 대칭키

### 7. Finished

- 서버 -> 클라이언트
- 해당 패킷을 통해 SSL HandShake를 종료합니다.


# 의문점

HTTP보다 HTTPS가 더 빠르다. why?

[HTTP vs HTTPS 속도 테스트](https://www.httpvshttps.com)
https://okky.kr/articles/480266
https://ko.myservername.com/http-vs-https-an-depth-comparison-features


[2018.06.05 기사 - 구글 크롬의 주소창 낙인, 어떻게 봐야 할까](https://zdnet.co.kr/view/?no=20180605105748)
[2018.05.24 기사 - “이 웹사이트는 안전하지 않음!” 브라우저별 HTTPS 연결과 HTTP 연결 표시법](https://www.itworld.co.kr/news/109420)

[2021.01.15 기사 - 2021년 구글 크롬 https 자동 연결 예정](https://cert.crosscert.com/%EF%BB%BF2021년-구글-크롬-https-자동-연결-예정/)


# References

[https://aws-hyoh.tistory.com/39](https://aws-hyoh.tistory.com/39)\
[https://ko.wikipedia.org/wiki/HTTPS](https://ko.wikipedia.org/wiki/HTTPS)
