---
title: AWS 인프라
author: Huey-J
date: 2021-06-15 12:00:00 +0800
categories: [데브옵스]
tags: [AWS]
---

# Route53

> AWS에서 제공하는 [DNS 서비스](https://ko.wikipedia.org/wiki/도메인_네임_시스템)

DNS 기능 뿐만 아니라 Load Balancing, 모니터링 등의 기능을 수행할 수 있다.\
국내 도메인 제공업체를 통해 등록해도 되고, 직접 AWS에서 발급받아서 사용할 수도 있다.

## 호스팅 영역 :: hosted zone

- 호스팅 영역 1개는 도메인 1개와 같다.
- 퍼블릭 유형: 인터넷과 연결된 도메인을 대상으로 한다.
- 프라이빗 유형: Amazon VPC 내에 있는 도메인을 대상으로 한다.

## 레코드 유형 :: record type

- A: Address
  - domain에 IPv4 주소를 할당하는 유형이다.
  - huey-j.com - 111.222.333.0
- CNAME: Canonical name
  - 다른 도메인 별칭(alias)을 부여한다.
  - cname.huey-j.com
- NS: Name Server Type
  - AWS에서 자동 생성되며 필수값이다.
  - NS는 총 4개로 구성되어 있는데, 이는 1개의 NS가 죽어 내 서비스에 접속이 불가능하게 되는 경우를 방지하기 위해서이다.
- SOA
  - AWS에서 자동 생성되며 필수값이다.
  - 해당 DNS 서버 자체의 설정 정보를 정의한다.

![aws record type](/assets/img/aws_record_type.png)


# ELB :: Elastic Load Balancer

> AWS에서 제공하는 Load Balancer

로드 밸런서는 여러 가용 영역에서 수신되는 트래픽을 분산시켜 부하를 낮춰주는 서비스이다.\
또한 부하 분산 대상에 대한 헬스 체크, 고정 세션, SSL 등의 기능을 수행한다.

## AWS-ACM

HTTPS 통신을 위해 AWS에서 제공하는 무료 SSL 인증서 발급 서비스이다.\
자동 갱신 기능이 있어 편리하다.\
인증서 발급을 위해선 유효한 도메인 주소가 있어야 한다. 즉 Route 53에 DNS서버가 등록되어 있어야 한다.

## 종류

ELB는 OSI 7계층에서 동작하는 위치에 따라 총 3개로 나뉜다.\
아래 예시 외의 프로토콜에서도 동작 가능하다.\
자세한 비교는 [여기](https://aws.amazon.com/ko/elasticloadbalancing/features/#Product_comparisons)에서

![aws load balancer type](/assets/img/aws_load_balancer_type.png)

- Application Load Balancer (ALB)
  - 7계층에 해당하는 Application Layer에서 동작한다.
  - HTTP, HTTPS, WebSocket의 헤더를 활용한다.
  - 일반적인 웹 서버의 경우 흔하게 사용한다.
- Network Load Balancer (NLB)
  - 4계층에 해당하는 Transport Layer에서 동작한다.
  - TCP, UDP를 활용한다.
  - UDP를 사용하는 서버가 있다면 NLB를 고려해 봐야 한다.
- Classic Load Balancer (CLB)
  - 4계층부터 7계층까지 적용가능하다.
  - 가장 오래된, 기본적인 형태의 로드밸런서이다.
  - 현재는 없어지는 추세
- Gateway Load Balancer (GWLB)
  - 3계층에 해당하는 Network Layer에서 동작한다.
  - 네트워크 트래픽이 애플리케이션으로 이동하기 전에 모든 트래픽을 검사하기 위해 사용할 수 있다.
  - 기존 3rd-party를 이용하여 방화벽을 구축하는 경우에 발생하는 운영 복잡도 증가 및 제약 사항에 대한 문제점들을 해결할 수 있다.
  - 2020년 11월에 출시되어 가장 최근에 생긴 로드밸런서이다.

## 간단한 동작 과정 (ALB)

실제로 사용자는 LB와 통신한다. 즉 프록시 서버라고 볼 수 있다.

  1. 사용자와 ALB의 3-way handshake
  2. ALB와 EC2 인스턴스의 3-way handshake
  3. 사용자가 ALB에 요청을 보내면 ALB가 EC2에 전달

- 입력 포트는 리스너라고 정의하며 80포트(http)로 요청받는 경우 443(https)로 redirect시킬 수도 있다.
- LB는 여러 인스턴스로 구성된 대상 그룹으로 전달하게 된다.


# Cloud Watch

> AWS 애플리케이션 모니터링 서비스

실행중인 애플리케이션의 지표를 감시하며 저장한다. 이를 통해 통계를 보거나, 임계값을 위반한 경우 상태를 변경하거나 알람을 보내주는 서비스이다.





# VPN, VPC, Subnet

- VPC
  - VPC 안에 서브넷을 나눈다.
  - 지역을 서브넷을 기준으로 나눈다.
  - 라우팅 테이블:
  - IKE 버전
    - Ikev2 : 터널 연결이 끊기면 은행에서 연결요청을 해줘야 함
    - Ikev1 : 우리쪽에서 연결 가능
- VPN
  - Virtual Private Network: 가상 사설망
  - 실제로 같은 네트워크 안에 있지만 가상으로 분리를 시킨 망을 의미한다.


# AMI, EBS

스토리지 (하드디스크와 같음), but AMI는 해당 볼륨을 기반으로 EC2를 생성할 수 있음



---

- RDS
- VPN
- VPC
- Subnet
- DMS RDS Replication to Viettel MySQL via VPN
- SES
- RI, saving plan: 비용 절감


- RDS
  - 운영은 mySql 엔진의 오로라를 사용한다
  - DMS: 데이터베이스 마이그레이션 태스크 : DB 복붙 배치 프로그램
  - 복제 인스턴스:
  - 엔드포인트:
- SES
  - 이메일 발송
  - 미국 region에 있음




# References

[aws route53](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/route-53-concepts.html)\
[aws route53-hosted zone](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/hosted-zones-working-with.html)






---


[Virtual Private Cloud](https://medium.com/harrythegreat/aws-가장쉽게-vpc-개념잡기-71eef95a7098)
[VPC](https://jbhs7014.tistory.com/164)
[ELB](https://aws-hyoh.tistory.com/128)
