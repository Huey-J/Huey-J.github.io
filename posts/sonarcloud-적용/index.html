<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="prefer-datetime-locale" content="ko"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="SonarCloud로 코드 분석하기" /><meta name="author" content="Huey-J" /><meta property="og:locale" content="en" /><meta name="description" content="1. 목표" /><meta property="og:description" content="1. 목표" /><link rel="canonical" href="https://huey-j.github.io/posts/sonarcloud-%EC%A0%81%EC%9A%A9/" /><meta property="og:url" content="https://huey-j.github.io/posts/sonarcloud-%EC%A0%81%EC%9A%A9/" /><meta property="og:site_name" content="Huey-J" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-03T13:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SonarCloud로 코드 분석하기" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Huey-J" /><meta name="google-site-verification" content="google252f47095b13bac6.html" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Huey-J"},"dateModified":"2023-08-16T00:49:11+09:00","datePublished":"2023-08-03T13:00:00+09:00","description":"1. 목표","headline":"SonarCloud로 코드 분석하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://huey-j.github.io/posts/sonarcloud-%EC%A0%81%EC%9A%A9/"},"url":"https://huey-j.github.io/posts/sonarcloud-%EC%A0%81%EC%9A%A9/"}</script><title>SonarCloud로 코드 분석하기 | Huey-J</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Huey-J"><meta name="application-name" content="Huey-J"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://user-images.githubusercontent.com/77145383/172538001-1852565d-fd93-4e2f-bba5-9f8f81880b2f.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Huey-J</a></div><div class="site-subtitle font-italic">a cheerful blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Huey-J" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wkdgus7113','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/hyeonhee-jang-a17b8521a" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SonarCloud로 코드 분석하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>SonarCloud로 코드 분석하기</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1691035200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 3, 2023 </em> </span> <span> Updated <em class="" data-ts="1692114551" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 16, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> Huey-J </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1811 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="1-목표">1. 목표</h1><p>SonarCloud를 이용하여 코드의 품질과 테스트 커버리지 등을 측정하고, Github Actions와 연동하여 PR 시 정적 분석 결과를 코멘트로 남겨주도록 설정한다.</p><blockquote class="prompt-info"><div><p>예제에서 다룬 코드는 <a href="https://github.com/Huey-J/sonarcloud-example">여기</a>서 확인할 수 있습니다.</p></div></blockquote><h1 id="2-sonarcloud-란">2. SonarCloud 란</h1><p>SonarCloud는 정적 분석 툴인 SonarQube의 SaaS 형태입니다.</p><p>여기서 정적 분석이란 애플리케이션을 실제 실행하지 않고 분석하는 것을 의미하며, 반대로는 동적 분석이 있습니다. 간단하게 얘기하면 제 코드를 보고 버그나 취약점, 냄새나는(?) 코드를 찾아주는 <del>배은망덕한</del> 고마운 친구죠 :)</p><p>PR에 코멘트도 달아주고, Quality Gates와 Github 설정을 연계해 머지에 대한 제약도 걸 수 있습니다.</p><p>그리고 뭐니 뭐니 해도 SonarCloud를 사용해야 할 가장 큰 이유는 분석 대상이 Public Repository인 경우 ‘무료’이기 떄문입니다! ㅎㅎ</p><p><img data-src="/assets/img/zzal/이말년_흐뭇.jpeg" alt="흐뭇" data-proofer-ignore> <em>공짜는 못 참지 크흠 흠…</em></p><blockquote><p><strong>SonarCloud 지표</strong></p><ul><li>Bugs(Reliability): 잠재적인 버그 혹은 실행시간에 예상되는 동작을 하지 않는 코드<li>Vulnerabilities(Security): 보안상 이슈가 있는 코드<li>Code Smells(Maintainability): 심각한 이슈는 아니지만 유지관리를 위해 개선하면 좋을 코드<li>Coverage: 테스트 커버리지<li>Duplications: 코드 중복<li>Security Hotspots: 취약성이 존재하는지 여부를 평가하기 위해 수동 검토가 필요한 코드</ul></blockquote><h1 id="3-기본-연동">3. 기본 연동</h1><p>가장 간단한 방법입니다. 준비물은 분석하고자 하는 Public Repository만 있으면 되고, 이것을 SonarCloud에 등록하여 default 브랜치를 분석합니다.</p><h2 id="프로젝트-연결"><span class="mr-2">프로젝트 연결</span><a href="#프로젝트-연결" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://sonarcloud.io/">SonarCloud</a> 에서 깃허브 계정으로 로그인 후 organization을 연결해 줍니다.</p><p>1.우측 상단 create new organization -&gt; Import an organization from Github</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_create_organization.png" alt="create_organization" data-proofer-ignore></p><p>2.Organization 선택 후 SonarCloud 에 분석하고자 하는 Repository를 선택해 줍니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_import_repository.png" alt="import_repository" data-proofer-ignore></p><p>3.free plan을 선택하고 넘어갑시다.(private repo는 유료) 여기서 설정하는 값들은 추후 언제든지 변경 가능하니 참고 해주세요 :)</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_import_repository_2.png" alt="import_repository_2" data-proofer-ignore></p><p>이후 분석할 repository를 다시 한번 선택하면 SonarCloud에 프로젝트가 생긴 걸 볼 수 있습니다. 분석 이력을 보면 아래 사진처럼 첫 분석이 Success로 잘 수행된 것을 확인할 수 있습니다!</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_first_background_task.png" alt="first_background_task" data-proofer-ignore></p><h2 id="pr-코멘트-확인"><span class="mr-2">PR 코멘트 확인</span><a href="#pr-코멘트-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>간단하게 SonarCloud에 등록만 해준 것 뿐인데 아래 PR처럼 코멘트도 자동으로 달아줍니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_first_pullrequest.png" alt="first_pullrequest" data-proofer-ignore> <em>https://github.com/Huey-J/sonarcloud-example/pull/1</em></p><p><img data-src="/assets/img/zzal/주목_움짤.gif" alt="주목" data-proofer-ignore> <em>짜자잔~</em></p><p>이는 Automatic Analysis 라는 설정이 기본적으로 켜져 있기 때문인데요! 아래에서 추가로 알아보는 걸로 하고 일단 넘어갑시다.</p><p>다시 PR 코멘트로 돌아와 내용을 보면 Bug는 없지만 Code Smell이 하나 있는걸 볼 수 있는데 SonarCloud에서 한번 확인해 볼까요?</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_first_pullrequest_code_smell.png" alt="first_pullrequest_code_smell" data-proofer-ignore></p><p>사용하지 않는 import문이 있으니 삭제하라고 권고하고 있습니다. 말 그대로 냄새 나는 코드군요. 🫣</p><p>여기까지가 가장 간단하게 SonarCloud를 연동하는 방법이었습니다. 굉장히 간단하죠? 하지만 뭔가 많이 부족한 것 같은데…</p><h1 id="3-테스트-커버리지-적용">3. 테스트 커버리지 적용</h1><p>위에서 봤던 PR 코멘트를 보면 <code class="language-plaintext highlighter-rouge">No Coverage information</code>라는 문구를 볼 수 있습니다. 말 그대로 테스트 코드의 커버리지 정보가 없다는 것인데요. 정적 분석에 커버리지가 없다니! 얼른 추가해 줍시다.</p><h2 id="ci-방식으로-전환"><span class="mr-2">CI 방식으로 전환</span><a href="#ci-방식으로-전환" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>SonarCloud는 자체적으로 커버리지를 분석하지는 않고, jacoco와 같은 테스트 커버리지 툴이 만든 보고서를 이용하여 보여주는 방식을 사용합니다. 즉, 커버리지 적용을 위해서는 jacoco가 필요하고, 보고서를 전달하기 위해 현재의 Auto 방식이 아닌 CI 방식으로 변경해야 하죠.</p><p>1.좌측 하단의 Analysis Method 메뉴로 들어가 Automatic Analysis를 끄고, 우리가 사용할 github action을 선택해 줍니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_coverage_setting.png" alt="coverage_setting" data-proofer-ignore></p><p>2.그리고 굉장히 친절하게 알려주는 설정 방법을 통해 Github Repository의 Secret을 추가해 줍니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_coverage_setting_2.png" alt="coverage_setting_2" data-proofer-ignore></p><p>3.workflow와 build.gradle을 수정하는데, 아래와 같이 Jacoco와 xml report를 생성하도록 설정합니다. JDK 버전에 주의합시다!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>plugins {
    id 'jacoco'
    id "org.sonarqube" version "4.2.1.3168"
}

sonar {
    properties {
        property "sonar.projectKey", "Huey-J_sonarcloud-example"
        property "sonar.organization", "huey-j"
        property "sonar.host.url", "https://sonarcloud.io"
    }
}

jacocoTestReport {
    reports {
        xml.enabled true
    }
}
</pre></table></code></div></div><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="na">name</span><span class="pi">:</span> <span class="s">SonarCloud</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">main</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="na">types</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">opened</span><span class="pi">,</span> <span class="nv">synchronize</span><span class="pi">,</span> <span class="nv">reopened</span><span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build and analyze</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">fetch-depth</span><span class="pi">:</span> <span class="m">0</span>  <span class="c1"># Shallow clones should be disabled for a better relevancy of analysis</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up JDK </span><span class="m">17</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-java@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">java-version</span><span class="pi">:</span> <span class="m">17</span>    <span class="c1"># JDK 버전</span>
          <span class="na">distribution</span><span class="pi">:</span> <span class="s1">'</span><span class="s">zulu'</span> <span class="c1"># Alternative distribution options are available</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache SonarCloud packages</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">~/.sonar/cache</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">$-sonar</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">$-sonar</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Cache Gradle packages</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">~/.gradle/caches</span>
          <span class="na">key</span><span class="pi">:</span> <span class="s">$-gradle-$</span>
          <span class="na">restore-keys</span><span class="pi">:</span> <span class="s">$-gradle</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build and analyze</span>
        <span class="na">env</span><span class="pi">:</span>
          <span class="na">GITHUB_TOKEN</span><span class="pi">:</span> <span class="s">$</span>  <span class="c1"># Needed to get PR information, if any</span>
          <span class="na">SONAR_TOKEN</span><span class="pi">:</span> <span class="s">$</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">./gradlew build jacocoTestReport sonar --info</span>    <span class="c1"># jacocoTestReport 추가</span>
</pre></table></code></div></div><p>위와 같이 수정 후 커밋, 푸시 하면 Github Actions가 정상적으로 수행되고, 테스트 커버리지가 잘 반영되는 것을 볼 수 있습니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_coverage_result_1.png" alt="coverage_result_1" data-proofer-ignore></p><p><img data-src="/assets/img/2023-08-03/sonarcloud_coverage_result_2.png" alt="coverage_result_2" data-proofer-ignore></p><p>이후 PR 코멘트에도 정상적으로 커버리지가 적용되는걸 확인할 수 있습니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_second_pullrequest.png" alt="second_pullrequest" data-proofer-ignore> <em>https://github.com/Huey-J/sonarcloud-example/pull/2</em></p><h1 id="4-세부-설정-추가">4. 세부 설정 추가</h1><h2 id="sonarcloud-pr-approve-조건-설정"><span class="mr-2">SonarCloud PR approve 조건 설정</span><a href="#sonarcloud-pr-approve-조건-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>SonarCloud Bot이 PR에 코멘트를 남길 때 approve, reject에 대한 조건이 있는데, 이를 Quality Gate라 부릅니다. 요걸 수정해 봅시다.</p><p>Organization -&gt; Quality Gates 에 들어가면 해당 Organization에 속한 통과 조건들이 있습니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_quality_gate_setting.png" alt="quality_gate_setting" data-proofer-ignore></p><p>위 이미지에서는 Default 설정을 복사하여 Coverage 통과 조건만 80에서 60으로 낮추었습니다. 그리고 맨 아래에 있는 Projects에 해당 Quality Gate를 적용할 프로젝트를 체크하면 이후 검증 작업부터 적용이 됩니다.</p><h2 id="pr-merge-조건에-sonarcloud-연동"><span class="mr-2">PR Merge 조건에 SonarCloud 연동</span><a href="#pr-merge-조건에-sonarcloud-연동" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>깃허브에서 SonarCloud 조건을 통과하지 못할 경우 Merge가 안되도록 설정할 수 있습니다.</p><p>Settings -&gt; Branches -&gt; Branch protection rule 머지 조건으로 Sonar Cloud를 추가해 줍니다.</p><p><img data-src="/assets/img/2023-08-03/sonarcloud_pr_merge_setting.png" alt="pr_merge_setting" data-proofer-ignore></p><h1 id="5-마무리">5. 마무리</h1><p>이번 글에서는 SonarCloud를 연동하여 정적 분석을 작업 프로세스에 추가하였습니다. 덕분에 코드의 품질과 테스트 커버리지에 대해 좀 더 고민하며 개발할 수 있지 않을까 라는 자그마한 기대를 해 봅니다. ㅎㅎ</p><p><del>테스트 커버리지를 적용하면서 build.yml 마지막 줄에 <code class="language-plaintext highlighter-rouge">jacocoTestReport</code>를 추가하지 않아 커버리지 적용이 안돼서 삽질한 건 안비밀..</del></p><p><img data-src="/assets/img/zzal/풀리퀘_승인.jpeg" alt="pr_approve" data-proofer-ignore></p><h1 id="references">References</h1><ul><li><a href="https://docs.sonarcloud.io/enriching/test-coverage/java-test-coverage/">https://docs.sonarcloud.io/enriching/test-coverage/java-test-coverage/</a><li><a href="https://community.sonarsource.com/t/jacoco-import-troubleshooting/35755">https://community.sonarsource.com/t/jacoco-import-troubleshooting/35755</a><li><a href="https://hyeon9mak.github.io/sonarcloud-trouble-shooting/">https://hyeon9mak.github.io/sonarcloud-trouble-shooting/</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/backend/'>backend</a>, <a href='/categories/spring/'>spring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spring/" class="post-tag no-text-decoration" >spring</a> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/github-actions/" class="post-tag no-text-decoration" >github actions</a> <a href="/tags/sonar-cloud/" class="post-tag no-text-decoration" >sonar cloud</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SonarCloud%EB%A1%9C+%EC%BD%94%EB%93%9C+%EB%B6%84%EC%84%9D%ED%95%98%EA%B8%B0+-+Huey-J&url=https%3A%2F%2Fhuey-j.github.io%2Fposts%2Fsonarcloud-%25EC%25A0%2581%25EC%259A%25A9%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SonarCloud%EB%A1%9C+%EC%BD%94%EB%93%9C+%EB%B6%84%EC%84%9D%ED%95%98%EA%B8%B0+-+Huey-J&u=https%3A%2F%2Fhuey-j.github.io%2Fposts%2Fsonarcloud-%25EC%25A0%2581%25EC%259A%25A9%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fhuey-j.github.io%2Fposts%2Fsonarcloud-%25EC%25A0%2581%25EC%259A%25A9%2F&text=SonarCloud%EB%A1%9C+%EC%BD%94%EB%93%9C+%EB%B6%84%EC%84%9D%ED%95%98%EA%B8%B0+-+Huey-J" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ConnectionPool-TransactionPool/">성능 평가 후기2 Transaction Pool, Connection Pool 성능 튜닝</a><li><a href="/posts/%EC%84%B1%EB%8A%A5%ED%8F%89%EA%B0%80-%ED%9B%84%EA%B8%B0/">성능 평가 후기</a><li><a href="/posts/sonarcloud-%EC%A0%81%EC%9A%A9/">SonarCloud로 코드 분석하기</a><li><a href="/posts/querydsl-%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85/">트러블 슈팅 - querydsl 문제</a><li><a href="/posts/HTTPS/">HTTPS</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/elastic-stack/">Elastic Stack</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/%EC%84%B1%EB%8A%A5-%ED%8A%9C%EB%8B%9D/">성능 튜닝</a> <a class="post-tag" href="/tags/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/">알고리즘</a></div></div><div id="friends"><div class="panel-heading">Friends</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a href="https://seongbuming.github.io" class="friends-list">Seongbuming</a> <a href="https://yejining.github.io" class="friends-list">Yejining</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/querydsl-%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85/"><div class="card-body"> <em class="small" data-ts="1683950400" data-df="ll" > May 13, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>트러블 슈팅 - querydsl 문제</h3><div class="text-muted small"><p> 회사에서 진행한 작업이기 때문에 실제 코드가 아닌 예시 코드로 적겠습니다. 상황 엔티티 상황 간단한 예시로 가게(Shop)와 해당 가게에서 파는 물건(Goods)이 각각 엔티티로 있다고 하겠습니다. @Entity public class shop { @Id private Long id; private String name; ...</p></div></div></a></div><div class="card"> <a href="/posts/static%EB%A9%94%EC%86%8C%EB%93%9C-vs-component%EB%A9%94%EC%86%8C%EB%93%9C/"><div class="card-body"> <em class="small" data-ts="1657252800" data-df="ll" > Jul 8, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>static 메소드 vs @component 메소드 (feat.싱글톤 패턴)</h3><div class="text-muted small"><p> 들어가며 스프링 프로젝트를 하면서 공통 클래스(예를 들면 유틸 클래스)를 만들 때 보통 static 방식과 @Component방식을 자주 사용합니다. 이번 포스트에서는 이 두 방식의 차이점과 장단점을 살펴보고 각각 어느 상황에 써야 더 효율적이고 스프링다운지 알아보도록 합시다. 예시 상황 예시로 상황을 그려봅시다. 스프링 프로젝트를 진행하면서 ...</p></div></div></a></div><div class="card"> <a href="/posts/%EC%84%B1%EB%8A%A5%ED%8F%89%EA%B0%80-%ED%9B%84%EA%B8%B0/"><div class="card-body"> <em class="small" data-ts="1696046400" data-df="ll" > Sep 30, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>성능 평가 후기</h3><div class="text-muted small"><p> 👀 성능 평가? 왜 하게 되었나? 9월에는 제가 속한 신규 플랫폼 팀에 큰 이벤트가 있었습니다. 바로 이름부터 무시무시한 플랫폼 성능 평가죠. 성능..뭐시기요..? 성능 평가… TPS… 전부 해 본적이 없는 것들이라 막막했지만 또 한편으로는 굉장히 설랬습니다. 새로운 도전이라는 생각에 말이죠. ㅎㅎ 결과적으로 무사히 통과하였고 성대한(?) 파...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/querydsl-%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85/" class="btn btn-outline-primary" prompt="Older"><p>트러블 슈팅 - querydsl 문제</p></a> <a href="/posts/%EC%84%B1%EB%8A%A5%ED%8F%89%EA%B0%80-%ED%9B%84%EA%B8%B0/" class="btn btn-outline-primary" prompt="Newer"><p>성능 평가 후기</p></a></div><hr /><section><div id="light-mode"> <script src="https://utteranc.es/client.js" repo="Huey-J/Huey-J.github.io" issue-term="url" label="💬" theme="github-light" crossorigin="anonymous" async> </script></div><div id="dark-mode"> <script src="https://utteranc.es/client.js" repo="Huey-J/Huey-J.github.io" issue-term="url" label="💬" theme="github-dark" crossorigin="anonymous" async> </script></div><script> var uttLight = document.getElementById("light-mode"); var uttDark = document.getElementById("dark-mode"); let initTheme = "light"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = "dark"; } if (initTheme === "dark") { uttLight.parentNode.removeChild(uttLight); } else { uttDark.parentNode.removeChild(uttDark); } </script></section></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/username">Huey-J</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/elastic-stack/">Elastic Stack</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/%EC%84%B1%EB%8A%A5-%ED%8A%9C%EB%8B%9D/">성능 튜닝</a> <a class="post-tag" href="/tags/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/">알고리즘</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
